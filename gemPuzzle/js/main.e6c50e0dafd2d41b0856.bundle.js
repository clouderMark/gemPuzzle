"use strict";(self.webpackChunkgempuzzle=self.webpackChunkgempuzzle||[]).push([[179],{175:(e,t,a)=>{a.d(t,{$:()=>W}),window.game={root:document.body,puzzle:document.createElement("div"),navigation:document.createElement("div"),shuffle:document.createElement("button"),stop:document.createElement("button"),save:document.createElement("button"),results:document.createElement("button"),moves:document.createElement("div"),time:document.createElement("div"),info:document.createElement("div"),size:16,gems:function(){return Array.from(game.puzzle.querySelectorAll(".gem"))},timer:void 0,audio:document.createElement("audio"),audioToggle:document.createElement("button"),mask:document.createElement("div"),youWon:document.createElement("div"),resultsTable:document.createElement("table"),tbody:document.createElement("tbody"),resultsList:[{date:"Date:",moves:"Amount mooves:",time:"Time:"}],gameSizes:document.createElement("div"),radios:function(){return Array.from(document.getElementsByClassName("radio"))}},window.game;const n=function(e){for(var t=[],a=0,n=Math.sqrt(game.size),o=0;o<n;o++){for(var s=[],r=0;r<n;r++)s.push(e[a]),a++;t.push(s)}return t},o=function(e,t){for(var a=Math.sqrt(game.size),n=0;n<a;n++)for(var o=0;o<a;o++)if(e===t[n][o])return{y:n,x:o}};function s(e,t,a){e.style.transform="translate(".concat(100*t,"%, ").concat(100*a,"%)")}function r(e,t){for(var a=0,n=0;n<e.length;n++)for(var o=0;o<e.length;o++)s(t[a],o,n),a++}function m(e){game.moves.textContent="Moves: ".concat(e),game.stop.classList.remove("button--stop"),game.stop.textContent="Stop"}var i=!0;function c(){i=!i,game.audio.src=i?"./assets/silence.mp3":"./assets/click.mp3"}function l(e){for(var t=[],a=1;a<=e.length;a++)t.push(a);e.sort((function(e,a){return t.indexOf(+e.innerHTML)-t.indexOf(+a.innerHTML)}));for(var n=Math.floor(100*Math.random())+2,o=0;o<n;o++){var s=e[14];e[14]=e[15],e[15]=s,s=e[10],e[10]=e[14],e[14]=s,s=e[9],e[9]=e[10],e[10]=s,s=e[5],e[5]=e[9],e[9]=s,s=e[4],e[4]=e[5],e[5]=s,s=e[8],e[8]=e[4],e[4]=s,s=e[12],e[12]=e[8],e[8]=s,s=e[13],e[13]=e[12],e[12]=s,s=e[14],e[14]=e[13],e[13]=s,s=e[15],e[15]=e[14],e[14]=s,s=e[11],e[11]=e[15],e[15]=s,s=e[7],e[7]=e[11],e[11]=s,s=e[3],e[3]=e[7],e[7]=s,s=e[2],e[2]=e[3],e[3]=s,s=e[6],e[6]=e[2],e[2]=s,s=e[5],e[5]=e[6],e[6]=s,s=e[1],e[1]=e[5],e[5]=s,s=e[0],e[0]=e[1],e[1]=s,s=e[4],e[4]=e[0],e[0]=s,s=e[8],e[8]=e[4],e[4]=s,s=e[12],e[12]=e[8],e[8]=s,s=e[13],e[13]=e[12],e[12]=s,s=e[14],e[14]=e[13],e[13]=s,s=e[15],e[15]=e[14],e[14]=s}}function u(e){e.preventDefault()}function d(e){e.dataTransfer.setData("inner",e.target.innerHTML)}function g(e){W(+e.dataTransfer.getData("inner"))}var v=0,f=0,p=0,L=game.size;game.puzzle.classList.add("puzzle"),game.navigation.classList.add("navigation"),game.shuffle.textContent="Shuffle and start",game.stop.textContent="Stop",game.save.textContent="Save",game.results.textContent="Results",game.info.classList.add("info"),game.moves.textContent="Moves: ".concat(v),game.time.textContent="Time: ".concat(p," : ").concat(f),game.audioToggle.classList.add("audioToggle"),game.mask.classList.add("mask"),game.youWon.classList.add("youWon"),game.resultsTable.classList.add("resultsTable"),game.gameSizes.classList.add("gameSizes"),game.gameSizes.textContent="Other sizes: ";for(var h=3;h<9;h++){var z=document.createElement("label"),E=document.createElement("input"),y=document.createElement("span");E.setAttribute("type","radio"),E.setAttribute("name","size"),4===h&&(E.checked=!0),E.classList.add("radio","radio--".concat(h),"visually-hidden"),z.classList.add("radio-label"),y.textContent="".concat(h," x ").concat(h),z.append(E,y),game.gameSizes.append(z)}c(),O(L),game.root.append(game.navigation,game.info,game.puzzle,game.gameSizes,game.audio,game.audioToggle,game.youWon,game.mask,game.resultsTable),game.navigation.append(game.shuffle,game.stop,game.save,game.results),game.info.append(game.moves,game.time),game.resultsTable.append(game.tbody);var b,T,x,S=game.gems(),k=game.radios();localStorage.getItem("saved15game")?(T=S,x=JSON.parse(localStorage.getItem("saved15game")),T.sort((function(e,t){return x.indexOf(+e.innerHTML)-x.indexOf(+t.innerHTML)})),localStorage.removeItem("saved15game")):l(S);var C=n(S.map((function(e){return+e.innerHTML})));r(C,S),game.shuffle.addEventListener("click",(function(){I(),l(S),r(C=n(S.map((function(e){return+e.innerHTML}))),S),f=-1,p=0,m(v=0),S[0].classList.contains("animation")&&S.map((function(e){return e.classList.remove("animation")}))})),game.puzzle.addEventListener("click",(function(e){W(+e.target.textContent)})),game.stop.addEventListener("click",(function(){(v>0||f>0||p>0)&&("Stop"===game.stop.innerHTML?(game.stop.textContent="Start",clearInterval(b)):(game.stop.textContent="Stop",f=f,p=p,I()),game.stop.classList.toggle("button--stop"))})),game.audioToggle.addEventListener("click",(function(){c(),game.audioToggle.classList.toggle("audioToggle--off")})),game.save.addEventListener("click",(function(){!function(e,t){e=e.map((function(e){return+e.innerHTML})),localStorage.setItem("saved15game",JSON.stringify(e)),localStorage.setItem("saved15results",JSON.stringify(t))}(S,game.resultsList)})),game.results.addEventListener("click",(function(){game.mask.classList.add("mask--open"),game.resultsTable.classList.add("resultsTable--open"),function(e){localStorage.getItem("saved15results")&&(e=JSON.parse(localStorage.getItem("saved15results")),localStorage.removeItem("saved15results")),console.log(e);for(var t=0;t<e.length;t++){var a=document.createElement("tr"),n=document.createElement("th"),o=document.createElement("th"),s=document.createElement("th");n.textContent=e[t].date,o.textContent=e[t].moves,s.textContent=e[t].time,a.append(n,o,s),game.tbody.append(a)}}(game.resultsList)})),game.mask.addEventListener("click",(function(){game.mask.classList.remove("mask--open"),game.youWon.classList.remove("youWon--open"),game.resultsTable.classList.remove("resultsTable--open"),game.tbody.replaceChildren()}));for(var M=function(e){k[e].addEventListener("change",(function(){game.size=(e+3)*(e+3),game.puzzle.replaceChildren(),O(game.size);var t=game.gems();(function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}})(t),r(C=n(t.map((function(e){return+e.innerHTML}))),t),console.log("Ммм,да...Это тот прикол который не удалось реализовать. При смене размера листенер на доске остается в начальном окружении. Не понял как в него прокинуть перетасованную матрицу")}))},H=0;H<k.length;H++)M(H);function I(){b&&clearInterval(b),b=setInterval((function(){60==++f&&(p++,f=0),game.time.textContent="Time: ".concat(p," : ").concat(f)}),1e3)}function O(e){for(var t=1;t<=e;t++){var a=document.createElement("div");a.classList.add("gem","gem--".concat(Math.sqrt(e))),a.textContent=t,t===e&&a.classList.add("gem--d-none"),a.addEventListener("dragstart",d,!1),t<e?a.setAttribute("draggable",!0):(a.addEventListener("dragover",u,!1),a.addEventListener("drop",g,!1)),game.puzzle.append(a)}}function W(e){var t=o(e,C),a=o(game.size,C);(function(e,t){try{var a=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return 1===a&&0===n||0===a&&1===n}catch(e){}})(t,a)&&(function(e,t,a){var n=Math.sqrt(game.size),o=a[e.y*n+e.x];a[e.y*n+e.x]=a[t.y*n+t.x],a[t.y*n+t.x]=o}(t,a,S),r(C=n(S.map((function(e){return+e.innerHTML}))),S),I(),m(++v),game.audio.play(),function(e){for(var t,a,n,o,s=[],r=1;r<=L;r++)s.push(r);(function(){for(var t=e.flat(),a=0;a<L;a++)if(s[a]!==t[a])return!1;return!0})()&&(game.mask.classList.add("mask--open"),game.youWon.textContent="Hooray! You solved the puzzle in ".concat(p,":").concat(f," and ").concat(v," moves!"),game.youWon.classList.add("youWon--open"),clearInterval(b),t=p,a=f,n=v,o={date:(new Date).toLocaleDateString(),moves:n,time:"".concat(t," : ").concat(a)},game.resultsList.push(o),game.resultsList.sort((function(e,t){return e.moves<t.moves?-1:1})),game.resultsList.length>11&&game.resultsList.splice(11,1))}(C)),S[0].classList.contains("animation")||S.map((function(e){return e.classList.add("animation")}))}}},e=>{e(e.s=175)}]);